 <!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="theme-color" content="#060b1a" />
<meta name="description" content="Production-ready, offline-first tariff solutions platform for US-Canada trade reform. Gamified policy analysis with IndexedDB storage, collaboration tools, and transparency tracking." />
<meta name="keywords" content="trade policy, US-Canada, tariff reform, restoration economics, democratic governance" />
<title>USâ€“Canada Restoration Tariff â€¢ Policy Hub</title>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='30' fill='%230b1022'/%3E%3Cpath d='M32 7l3.5 8.9 9.6.7-7.4 6.1 2.4 9.3-8.1-4.9-8.1 4.9 2.4-9.3-7.4-6.1 9.6-.7L32 7z' fill='%23a8d6ff'/%3E%3C/svg%3E" />
<script src="https://cdn.tailwindcss.com"></script>
<style>
:root, [data-theme="space"]{
  --bg:#060b1a; --panel:#0d1428; --card:#0f1a34; --ink:#e8f1ff; --muted:#a9b9d6;
  --brand:#59d2ff; --ok:#34d399; --warn:#fbbf24; --bad:#f87171; --ring:rgba(89,210,255,.35);
  --accent1:#a78bfa; --accent2:#fb923c; --glow:rgba(89,210,255,.6);
}
[data-theme="medieval"]{
  --bg:#0a0604; --panel:#1a0f0a; --card:#2a1810; --ink:#f4e4d7; --muted:#c4a882;
  --brand:#d4a574; --ok:#7cb342; --warn:#ff9800; --bad:#d32f2f; --ring:rgba(212,165,116,.4);
  --accent1:#8d6e63; --accent2:#ffb74d; --glow:rgba(212,165,116,.5);
}
[data-theme="anime"]{
  --bg:#0d0220; --panel:#1a0838; --card:#2d1055; --ink:#fef0ff; --muted:#d4b5f7;
  --brand:#ff6ec7; --ok:#00e676; --warn:#ffd740; --bad:#ff1744; --ring:rgba(255,110,199,.4);
  --accent1:#7c4dff; --accent2:#ffab40; --glow:rgba(255,110,199,.6);
}
[data-theme="forest"]{
  --bg:#061008; --panel:#0d1e12; --card:#14321d; --ink:#e8f5e9; --muted:#a5d6a7;
  --brand:#66bb6a; --ok:#81c784; --warn:#ffb74d; --bad:#e57373; --ring:rgba(102,187,106,.4);
  --accent1:#4db6ac; --accent2:#aed581; --glow:rgba(102,187,106,.5);
}
[data-theme="cyberpunk"]{
  --bg:#0a0014; --panel:#1a0028; --card:#2d004a; --ink:#f0feff; --muted:#d896ff;
  --brand:#ff00ff; --ok:#00ff41; --warn:#ffea00; --bad:#ff073a; --ring:rgba(255,0,255,.5);
  --accent1:#00ffff; --accent2:#ff9e00; --glow:rgba(255,0,255,.8);
}

*{box-sizing:border-box; margin:0; padding:0}
html{scroll-behavior:smooth}
html,body{height:100%; overflow-x:hidden}
body{
  margin:0;
  background:radial-gradient(1200px 800px at 70% -10%,#142349 0%,var(--bg) 55%),#000;
  color:var(--ink);
  font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Inter,Arial;
  position:relative;
  transition:background .6s ease, color .4s ease;
}

canvas#sky{position:fixed;inset:0;width:100%;height:100%;z-index:-3;display:block;will-change:transform}
#nebula{position:fixed;inset:0;pointer-events:none;mix-blend-mode:screen;opacity:.35;z-index:-2;will-change:opacity}
#constellation{position:fixed;inset:0;pointer-events:none;z-index:-1;will-change:transform;transition:opacity .5s ease}

.backdrop{backdrop-filter:saturate(120%) blur(12px); -webkit-backdrop-filter:saturate(120%) blur(12px)}
.card{
  background:linear-gradient(135deg,rgba(255,255,255,.08),rgba(255,255,255,.02));
  border:1px solid rgba(255,255,255,.12);
  border-radius:1.2rem;
  box-shadow:0 8px 32px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.1);
  position:relative;
  overflow:hidden;
  transition:transform .3s ease, box-shadow .3s ease;
}
.card:hover{transform:translateY(-2px); box-shadow:0 12px 40px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.15)}
.card::before{
  content:'';
  position:absolute;
  inset:0;
  background:radial-gradient(circle at var(--mouse-x,50%) var(--mouse-y,50%), var(--glow) 0%, transparent 60%);
  opacity:0;
  transition:opacity .4s ease;
  pointer-events:none;
}
.card:hover::before{opacity:.15}

.btn{
  display:inline-flex; align-items:center; gap:.5rem;
  border:1px solid rgba(255,255,255,.15);
  padding:.7rem 1.2rem;
  border-radius:.9rem;
  background:rgba(255,255,255,.03);
  color:var(--ink);
  font-weight:500;
  cursor:pointer;
  transition:all .25s ease;
  position:relative;
  overflow:hidden;
}
.btn::before{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(135deg, var(--brand), var(--accent1));
  opacity:0;
  transition:opacity .3s ease;
}
.btn:hover:not(:disabled){
  border-color:var(--brand);
  transform:translateY(-1px);
  box-shadow:0 4px 16px var(--ring);
}
.btn:hover:not(:disabled)::before{opacity:.12}
.btn:active:not(:disabled){transform:translateY(0)}
.btn:disabled{opacity:.5; cursor:not-allowed}
.btn>*{position:relative; z-index:1}

.tab{
  cursor:pointer;
  border-bottom:2px solid transparent;
  padding:.7rem 1.2rem;
  transition:all .3s ease;
  position:relative;
  font-weight:500;
}
.tab::after{
  content:'';
  position:absolute;
  bottom:0;
  left:50%;
  width:0;
  height:2px;
  background:linear-gradient(90deg, var(--brand), var(--accent1));
  transition:all .3s ease;
  transform:translateX(-50%);
}
.tab.active{color:var(--brand)}
.tab.active::after{width:100%}
.tab:hover:not(.active){color:var(--accent1); transform:translateY(-2px)}

input,select,textarea{
  background:rgba(255,255,255,.05);
  border:1px solid rgba(255,255,255,.15);
  border-radius:.7rem;
  padding:.7rem .9rem;
  color:var(--ink);
  outline:none;
  font-family:inherit;
  transition:all .3s ease;
  width:100%;
}
input:focus,select:focus,textarea:focus{
  border-color:var(--brand);
  box-shadow:0 0 0 4px var(--ring), 0 4px 16px rgba(0,0,0,.2);
  background:rgba(255,255,255,.08);
}
input::placeholder,textarea::placeholder{color:var(--muted); opacity:.6}
input:disabled,select:disabled,textarea:disabled{opacity:.5; cursor:not-allowed}

.collapse-header{
  cursor:pointer;
  padding:1rem 1.5rem;
  background:rgba(255,255,255,.04);
  border:1px solid rgba(255,255,255,.1);
  border-radius:.8rem;
  display:flex;
  align-items:center;
  justify-content:space-between;
  transition:all .3s ease;
  margin-bottom:.5rem;
}
.collapse-header:hover{
  background:rgba(255,255,255,.08);
  border-color:var(--brand);
  transform:translateX(4px);
}
.collapse-icon{
  transition:transform .3s ease;
  font-size:1.2rem;
  color:var(--brand);
}
.collapse-header.active .collapse-icon{transform:rotate(90deg)}
.collapse-content{
  max-height:0;
  overflow:hidden;
  transition:max-height .5s cubic-bezier(0.4, 0, 0.2, 1);
  padding:0 1rem;
}
.collapse-content.active{max-height:8000px; padding:1rem}

#hud{
  position:fixed;
  top:6rem;
  right:1.5rem;
  z-index:20;
  min-width:280px;
}
.hud-panel{
  background:linear-gradient(135deg,rgba(255,255,255,.1),rgba(255,255,255,.03));
  backdrop-filter:blur(16px);
  border:1px solid rgba(255,255,255,.2);
  border-radius:1rem;
  padding:1rem;
  box-shadow:0 8px 32px rgba(0,0,0,.4);
  margin-bottom:.75rem;
}
.hud-stat{
  display:flex;
  align-items:center;
  justify-content:space-between;
  margin:.5rem 0;
  font-size:.9rem;
}
.hud-label{color:var(--muted); font-weight:500}
.hud-value{color:var(--brand); font-weight:700; font-size:1.1rem}

.progress{
  height:10px;
  border-radius:999px;
  background:rgba(255,255,255,.1);
  overflow:hidden;
  position:relative;
}
.progress>i{
  display:block;
  height:100%;
  background:linear-gradient(90deg,var(--brand),var(--accent1));
  transition:width .6s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:0 0 12px var(--glow);
}
.progress>i::after{
  content:'';
  position:absolute;
  inset:0;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,.4), transparent);
  animation:shimmer 2s infinite;
}
@keyframes shimmer{
  0%{transform:translateX(-100%)}
  100%{transform:translateX(100%)}
}

.badge{
  font-size:.75rem;
  padding:.3rem .6rem;
  border-radius:.6rem;
  border:1px solid rgba(255,255,255,.2);
  background:rgba(255,255,255,.08);
  display:inline-block;
  font-weight:600;
  transition:all .3s ease;
}
.badge:hover{
  background:rgba(255,255,255,.15);
  transform:scale(1.05);
  box-shadow:0 2px 8px var(--ring);
}

h1,h2,h3,h4,h5,h6{font-weight:700; line-height:1.3; margin-bottom:.75rem}
h1{font-size:2.5rem}
h2{font-size:2rem}
h3{font-size:1.5rem}
p{margin-bottom:1rem}
kbd{
  background:#111a33;
  border:1px solid rgba(255,255,255,.15);
  padding:.25rem .5rem;
  border-radius:.4rem;
  font-family:monospace;
  font-size:.85rem;
}
hr{
  border:none;
  border-top:1px solid rgba(255,255,255,.12);
  margin:1.5rem 0;
}

@keyframes fadeIn{
  from{opacity:0; transform:translateY(20px)}
  to{opacity:1; transform:translateY(0)}
}
@keyframes pulse{
  0%, 100%{opacity:1}
  50%{opacity:.6}
}
@keyframes slideInRight{
  from{transform:translateX(100%); opacity:0}
  to{transform:translateX(0); opacity:1}
}
.animate-in{animation:fadeIn .6s ease forwards}
.pulse{animation:pulse 2s ease-in-out infinite}

[data-tooltip]{position:relative; cursor:help}
[data-tooltip]::before{
  content:attr(data-tooltip);
  position:absolute;
  bottom:calc(100% + 8px);
  left:50%;
  transform:translateX(-50%) translateY(-4px);
  background:rgba(0,0,0,.95);
  color:#fff;
  padding:.5rem .75rem;
  border-radius:.5rem;
  font-size:.8rem;
  white-space:nowrap;
  opacity:0;
  pointer-events:none;
  transition:all .3s ease;
  z-index:100;
  border:1px solid rgba(255,255,255,.2);
}
[data-tooltip]:hover::before{
  opacity:1;
  transform:translateX(-50%) translateY(0);
}

.loading-spinner{
  border:3px solid rgba(255,255,255,.1);
  border-top:3px solid var(--brand);
  border-radius:50%;
  width:24px;
  height:24px;
  animation:spin 1s linear infinite;
  display:inline-block;
}
@keyframes spin{
  0%{transform:rotate(0deg)}
  100%{transform:rotate(360deg)}
}

.error-message{
  background:rgba(248,113,113,.1);
  border:1px solid rgba(248,113,113,.3);
  color:#fca5a5;
  padding:.75rem 1rem;
  border-radius:.7rem;
  margin:.5rem 0;
}

.success-message{
  background:rgba(52,211,153,.1);
  border:1px solid rgba(52,211,153,.3);
  color:#6ee7b7;
  padding:.75rem 1rem;
  border-radius:.7rem;
  margin:.5rem 0;
}

@media (max-width: 1024px){
  #hud{right:1rem; min-width:240px}
}
@media (max-width: 760px){
  body{font-size:14px}
  h1{font-size:1.8rem}
  h2{font-size:1.5rem}
  h3{font-size:1.2rem}
  .card{border-radius:.8rem; padding:1rem!important}
  #hud{position:static; width:100%; margin:1rem; min-width:0}
  nav{display:none!important}
}

@media (prefers-reduced-motion: reduce){
  *{animation-duration:.01ms!important; animation-iteration-count:1!important; transition-duration:.01ms!important}
}

@media print{
  body{background:#fff; color:#000}
  canvas,#hud,header,footer,nav,.btn{display:none!important}
  .card{border:1px solid #ccc; box-shadow:none}
  main{padding:0; max-width:100%}
}

.hidden{display:none!important}
.flex{display:flex}
.grid{display:grid}
.items-center{align-items:center}
.justify-between{justify-content:space-between}
.gap-2{gap:.5rem}
.gap-3{gap:.75rem}
.gap-4{gap:1rem}
.mt-2{margin-top:.5rem}
.mt-3{margin-top:.75rem}
.mt-4{margin-top:1rem}
.mb-2{margin-bottom:.5rem}
.mb-3{margin-bottom:.75rem}
.mb-4{margin-bottom:1rem}
.p-3{padding:.75rem}
.p-4{padding:1rem}
.p-6{padding:1.5rem}
.text-center{text-align:center}
.font-bold{font-weight:700}
.text-sm{font-size:.875rem}
.text-xs{font-size:.75rem}
.space-y-4>*+*{margin-top:1rem}
.space-y-6>*+*{margin-top:1.5rem}
</style>
</head>
<body data-theme="space">

<canvas id="sky"></canvas>
<canvas id="nebula"></canvas>
<canvas id="constellation"></canvas>

<div id="hud" aria-label="User progress dashboard">
  <div class="hud-panel">
    <div class="hud-stat">
      <span class="hud-label">Level</span>
      <span class="hud-value" id="hudLevel" aria-live="polite">1</span>
    </div>
    <div class="progress" role="progressbar" aria-label="Experience progress">
      <i id="hudXPBar" style="width:0%"></i>
    </div>
    <div class="hud-stat">
      <span class="hud-label">XP</span>
      <span class="hud-value" id="hudXP" aria-live="polite">0 / 100</span>
    </div>
  </div>
  <div class="hud-panel">
    <div class="hud-stat">
      <span class="hud-label">Completed</span>
      <span class="hud-value" id="hudCompleted" aria-live="polite">0</span>
    </div>
    <div class="hud-stat">
      <span class="hud-label">Achievements</span>
      <span class="hud-value" id="hudAchievements" aria-live="polite">0</span>
    </div>
  </div>
</div>

<header class="fixed top-0 inset-x-0 z-10" role="banner">
  <div class="mx-auto max-w-7xl p-3">
    <div class="card backdrop flex items-center justify-between px-4 py-3">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg border border-sky-300/30 grid place-items-center bg-white/5" aria-hidden="true">
          <span class="text-sky-300 text-xl">âœ¦</span>
        </div>
        <div>
          <h1 class="text-lg font-semibold tracking-wide">USâ€“Canada Restoration Tariff</h1>
          <p class="text-xs text-sky-200/80">Trade â†’ Regeneration â†’ Planetary Restoration</p>
        </div>
      </div>
      <nav class="hidden md:flex items-center gap-2 text-sm" role="navigation" aria-label="Main navigation">
        <button data-tab="overview" class="tab active" aria-label="Overview section">Overview</button>
        <button data-tab="policy" class="tab" aria-label="Policy Builder section">Policy Builder</button>
        <button data-tab="quests" class="tab" aria-label="Quests section">Quests</button>
        <button data-tab="board" class="tab" aria-label="Leaderboard section">Leaderboard</button>
        <button data-tab="identity" class="tab" aria-label="Identity section">Identity</button>
        <button data-tab="settings" class="tab" aria-label="Settings section">Settings</button>
      </nav>
      <div class="flex items-center gap-2">
        <span id="statusDot" class="inline-block w-2.5 h-2.5 rounded-full bg-emerald-400 pulse" 
          data-tooltip="IndexedDB Connected" aria-label="Database status indicator"></span>
        <label for="themeSelect" class="sr-only">Select theme</label>
        <select id="themeSelect" class="text-xs px-2 py-1" data-tooltip="Change visual theme" aria-label="Theme selector">
          <option value="space">Space</option>
          <option value="medieval">Medieval</option>
          <option value="anime">Anime</option>
          <option value="forest">Forest</option>
          <option value="cyberpunk">Cyberpunk</option>
        </select>
      </div>
    </div>
  </div>
</header>

<main class="mx-auto max-w-7xl px-3 pb-32 pt-28" role="main">
  
  <section id="tab-overview" class="space-y-6">
    <div class="card backdrop p-6 animate-in">
      <h2 class="text-3xl font-semibold mb-3">Mission: Tariffs for Restoration</h2>
      <p class="text-lg text-sky-100/90 leading-relaxed">
        A comprehensive, offlineâ€‘first platform to design, simulate, and deploy a 
        <span class="font-bold text-brand">restorationâ€‘aligned trade regime</span> between the 
        United States and Canada. This system addresses all major trade sectors with tariff structures 
        that incentivize regenerative practices, penalize extractive models, and fund a biâ€‘national 
        Just Transition & Restoration Fund.
      </p>
    </div>

    <div class="grid md:grid-cols-3 gap-4">
      <div class="card backdrop p-5 animate-in">
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm text-sky-200">Integrity</span>
          <span class="badge bg-emerald-500/20 text-emerald-300 border-emerald-500/30">PASS</span>
        </div>
        <div class="text-2xl font-bold text-emerald-300 mb-1">100%</div>
        <p class="text-xs text-sky-300/80">Localâ€‘first, verifiable state. All data cryptographically signed.</p>
      </div>
      <div class="card backdrop p-5 animate-in" style="animation-delay:.1s">
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm text-sky-200">Schema Version</span>
          <span class="badge">v2.1</span>
        </div>
        <div class="text-sm text-sky-100 mb-1 font-mono">
          /restorationâ€‘tariff/comprehensive
        </div>
        <p class="text-xs text-sky-300/80">Modular, exportable JSON with full audit trail.</p>
      </div>
      <div class="card backdrop p-5 animate-in" style="animation-delay:.2s">
        <div class="flex items-center justify-between mb-2">
          <span class="text-sm text-sky-200">Completion</span>
          <span id="overviewPercent" class="badge">0%</span>
        </div>
        <div class="progress mt-2" role="progressbar" aria-label="Overall completion">
          <i id="progressBar" style="width:0%"></i>
        </div>
        <p class="text-xs text-sky-300/80 mt-2">Quests completed across all sectors.</p>
      </div>
    </div>

    <div class="card backdrop p-6">
      <h3 class="text-2xl font-semibold mb-3">Restoration Framework</h3>
      <p class="text-sky-100/90 mb-4">
        This platform provides solutions for <strong>all major USâ€‘Canada trade issues</strong> 
        through five integrated mechanisms:
      </p>
      <div class="space-y-3">
        <div class="flex gap-3 items-start">
          <span class="badge bg-brand/20 text-brand border-brand/30">01</span>
          <div class="flex-1">
            <h4 class="font-semibold text-brand">Differential Tariffs</h4>
            <p class="text-sm text-sky-100/80">
              Progressive tariff bands (0% to 35%) based on verified regenerative practices.
            </p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <span class="badge bg-brand/20 text-brand border-brand/30">02</span>
          <div class="flex-1">
            <h4 class="font-semibold text-brand">Ecosystem Credits</h4>
            <p class="text-sm text-sky-100/80">
              Carbon sequestration, watershed restoration, biodiversity offsets reduce tariffs.
            </p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <span class="badge bg-brand/20 text-brand border-brand/30">03</span>
          <div class="flex-1">
            <h4 class="font-semibold text-brand">Crossâ€‘Border Zones</h4>
            <p class="text-sm text-sky-100/80">
              Preferential zones with joint governance and accelerated restoration.
            </p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <span class="badge bg-brand/20 text-brand border-brand/30">04</span>
          <div class="flex-1">
            <h4 class="font-semibold text-brand">Just Transition Fund</h4>
            <p class="text-sm text-sky-100/80">
              100% of tariff revenue recycled into worker retraining and restoration.
            </p>
          </div>
        </div>
        <div class="flex gap-3 items-start">
          <span class="badge bg-brand/20 text-brand border-brand/30">05</span>
          <div class="flex-1">
            <h4 class="font-semibold text-brand">Verification Infrastructure</h4>
            <p class="text-sm text-sky-100/80">
              Public ledgers, audits, satellite monitoring, community reporting.
            </p>
          </div>
        </div>
      </div>
      <div class="mt-5 flex flex-wrap gap-2">
        <button class="btn" id="btnExportAll" data-tooltip="Export all data as JSON" aria-label="Export all data">
          ğŸ“¤ Export All Data
        </button>
        <button class="btn" id="btnPDF" data-tooltip="Print or save as PDF" onclick="window.print()" aria-label="Export as PDF">
          ğŸ–¨ï¸ Export PDF
        </button>
      </div>
    </div>

    <div id="corruptionTrackerContainer"></div>
  </section>

  <section id="tab-policy" class="hidden space-y-6">
    <div class="card backdrop p-6">
      <h3 class="text-2xl font-semibold mb-3">Policy Builder</h3>
      <p class="text-sky-100/90">Design your own restoration-aligned tariff package. All changes auto-save to IndexedDB.</p>
      <form id="policyForm" class="grid md:grid-cols-2 gap-4 mt-4">
        <label class="block">
          <span class="text-sm text-sky-200 font-semibold">Policy Title</span>
          <input id="plcyTitle" type="text" placeholder="USâ€“Canada Restoration Tariff v1" required />
        </label>
        <label class="block">
          <span class="text-sm text-sky-200 font-semibold">Version</span>
          <input id="plcyVersion" type="text" placeholder="1.0.0" pattern="[0-9]+\.[0-9]+\.[0-9]+" required />
        </label>
        <label class="block md:col-span-2">
          <span class="text-sm text-sky-200 font-semibold">Executive Summary</span>
          <textarea id="plcySummary" rows="4" placeholder="Describe what this policy achieves..." required></textarea>
        </label>
      </form>
      
      <hr class="my-6"/>
      
      <div class="flex flex-wrap gap-3">
        <button class="btn" id="btnSavePolicy" data-tooltip="Save current policy" aria-label="Save policy">
          ğŸ’¾ Save Policy
        </button>
        <button class="btn" id="btnSimulatePolicy" data-tooltip="Run impact simulation" aria-label="Run simulation">
          ğŸ“Š Simulate Impact
        </button>
      </div>
      <div id="policyMessages"></div>
      <pre id="policyOutput" class="mt-4 p-4 bg-black/50 rounded-lg text-xs max-h-60 overflow-auto hidden" aria-live="polite"></pre>
    </div>

    <div id="policySectorsContainer"></div>
  </section>

  <section id="tab-quests" class="hidden space-y-6">
    <div class="card backdrop p-6">
      <h3 class="text-2xl font-semibold mb-3">Quests & Challenges</h3>
      <p class="text-sky-100/90 mb-4">
        Complete these challenges to earn XP and level up. Quests range from policy analysis 
        to grassroots organizing to technical implementation.
      </p>
      <div id="questList" class="grid md:grid-cols-2 gap-4"></div>
      
      <div class="mt-6">
        <h4 class="font-semibold mb-3">Create Custom Quest</h4>
        <form id="questForm" class="grid md:grid-cols-3 gap-3">
          <label for="newQuestTitle" class="sr-only">Quest title</label>
          <input id="newQuestTitle" type="text" placeholder="Quest title" required />
          <label for="newQuestXP" class="sr-only">XP reward</label>
          <input id="newQuestXP" type="number" placeholder="XP reward" value="50" min="1" max="1000" required />
          <button type="submit" class="btn" aria-label="Create new quest">Create Quest</button>
        </form>
      </div>
    </div>
  </section>

  <section id="tab-board" class="hidden space-y-6">
    <div class="card backdrop p-6">
      <h3 class="text-2xl font-semibold mb-3">Leaderboard</h3>
      <p class="text-sky-100/90 mb-4">
        Local-first scoreboard. All entries are cryptographically signed.
      </p>
      <div class="overflow-x-auto">
        <table class="w-full text-left text-sm">
          <thead class="text-sky-200/90 border-b border-white/10">
            <tr>
              <th class="py-3 px-4" scope="col">Rank</th>
              <th class="py-3 px-4" scope="col">Identity</th>
              <th class="py-3 px-4" scope="col">Level</th>
              <th class="py-3 px-4" scope="col">XP</th>
              <th class="py-3 px-4" scope="col">Achievements</th>
            </tr>
          </thead>
          <tbody id="leaderboardBody" class="text-sky-100/90">
          </tbody>
        </table>
      </div>
      <div class="mt-4">
        <button class="btn" id="btnRefreshBoard" aria-label="Refresh leaderboard">ğŸ”„ Refresh Leaderboard</button>
      </div>
    </div>
  </section>

  <section id="tab-identity" class="hidden space-y-6">
    <div class="card backdrop p-6">
      <h3 class="text-2xl font-semibold mb-3">Identity & Credentials</h3>
      <p class="text-sky-100/90 mb-4">
        Your decentralized identity for signing policies and proposals. All credentials stored locally.
      </p>
      
      <form id="identityForm" class="grid md:grid-cols-2 gap-4">
        <label class="block">
          <span class="text-sm text-sky-200 font-semibold">Display Name</span>
          <input id="identityName" type="text" placeholder="Your name or alias" required />
        </label>
        <label class="block">
          <span class="text-sm text-sky-200 font-semibold">Organization</span>
          <input id="identityOrg" type="text" placeholder="Your organization" />
        </label>
        <label class="block md:col-span-2">
          <span class="text-sm text-sky-200 font-semibold">Public Key (auto-generated)</span>
          <input id="identityPubKey" type="text" readonly placeholder="Will be generated on first save" aria-readonly="true" />
        </label>
      </form>
      
      <div class="mt-4 flex flex-wrap gap-3">
        <button class="btn" id="btnSaveIdentity" aria-label="Save identity">ğŸ’¾ Save Identity</button>
        <button class="btn" id="btnExportIdentity" aria-label="Export credentials">ğŸ“¤ Export Credentials</button>
      </div>
      
      <div class="mt-6 p-4 bg-black/30 rounded-lg">
        <h4 class="font-semibold mb-2 text-sm">ğŸ” Security Notice</h4>
        <p class="text-xs text-sky-200/80">
          Your identity is stored locally using IndexedDB. Credentials never leave your device unless you explicitly export them.
          All policy signatures use your private key which is encrypted at rest.
        </p>
      </div>
      
      <div id="identityMessages"></div>
    </div>
  </section>

  <section id="tab-settings" class="hidden space-y-6">
    <div class="card backdrop p-6">
      <h3 class="text-2xl font-semibold mb-3">Settings & Configuration</h3>
      
      <div class="space-y-6">
        <div>
          <h4 class="font-semibold mb-3">Data Management</h4>
          <div class="flex flex-wrap gap-3">
            <button class="btn" id="btnExportDB" aria-label="Export database">ğŸ“¦ Export Database</button>
            <button class="btn" id="btnImportDB" aria-label="Import database">ğŸ“¥ Import Database</button>
            <button class="btn" id="btnClearDB" aria-label="Clear all data">ğŸ—‘ï¸ Clear All Data</button>
          </div>
          <input type="file" id="importFileInput" accept=".json" class="hidden" aria-label="File input for import" />
        </div>
        
        <hr/>
        
        <div>
          <h4 class="font-semibold mb-3">Display Preferences</h4>
          <label class="block mb-3">
            <span class="text-sm text-sky-200 font-semibold">Animation Speed: <span id="animSpeedValue">1.0x</span></span>
            <input type="range" id="animSpeed" min="0.5" max="2" step="0.1" value="1" 
              class="w-full" data-tooltip="Adjust constellation animation speed" 
              aria-label="Animation speed slider" />
          </label>
          
          <label class="flex items-center gap-3 cursor-pointer">
            <input type="checkbox" id="toggleParallax" checked aria-label="Toggle parallax effects" />
            <span class="text-sm">Enable parallax effects</span>
          </label>
          
          <label class="flex items-center gap-3 cursor-pointer mt-3">
            <input type="checkbox" id="toggleAnimations" checked aria-label="Toggle animations" />
            <span class="text-sm">Enable animations</span>
          </label>
        </div>
        
        <hr/>
        
        <div>
          <h4 class="font-semibold mb-3">Collaboration</h4>
          <p class="text-sm text-sky-200/80 mb-3">
            Share your work with others or collaborate in real-time (experimental).
          </p>
          <div class="flex flex-wrap gap-3">
            <button class="btn" id="btnShareLink" aria-label="Generate share link">ğŸ”— Generate Share Link</button>
            <button class="btn" id="btnCollabMode" aria-label="Enable collaboration">ğŸ‘¥ Enable Collaboration</button>
          </div>
          <pre id="shareOutput" class="mt-3 p-3 bg-black/50 rounded-lg text-xs max-h-40 overflow-auto hidden" aria-live="polite"></pre>
        </div>
        
        <hr/>
        
        <div>
          <h4 class="font-semibold mb-3">About</h4>
          <p class="text-sm text-sky-200/80">
            <strong>Version:</strong> 2.1.0<br/>
            <strong>Last Updated:</strong> October 2025<br/>
            <strong>License:</strong> Creative Commons BY-SA 4.0<br/>
            <strong>Purpose:</strong> Democratic tool for transparent trade policy reform<br/>
            <strong>Privacy:</strong> All data stored locally. No tracking. No analytics.
          </p>
        </div>
        
        <div id="settingsMessages"></div>
      </div>
    </div>
  </section>

</main>

<footer class="fixed bottom-0 inset-x-0 z-5 pointer-events-none" role="contentinfo">
  <div class="mx-auto max-w-7xl p-3">
    <div class="card backdrop px-4 py-2 flex items-center justify-between text-xs pointer-events-auto">
      <span class="text-sky-200/70">Offline-first â€¢ Zero tracking â€¢ Your data stays yours</span>
      <span class="text-sky-200/70">Press <kbd>?</kbd> for shortcuts</span>
    </div>
  </div>
</footer>

<div id="modalContainer" role="dialog" aria-modal="true" aria-hidden="true"></div>

<script>
'use strict';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PRODUCTION CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CONFIG = {
  VERSION: '2.1.0',
  DB_NAME: 'RestorationTariffDB',
  DB_VERSION: 1,
  XP_PER_LEVEL: 100,
  MAX_LEVEL: 100,
  AUTOSAVE_DELAY: 1000,
  ANIMATION_DURATION: 300,
  NOTIFICATION_DURATION: 4000,
  DEBUG: false
};

const log = (...args) => CONFIG.DEBUG && console.log('[App]', ...args);
const error = (...args) => console.error('[Error]', ...args);

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILITY FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const $ = (selector, parent = document) => parent.querySelector(selector);
const $$ = (selector, parent = document) => Array.from(parent.querySelectorAll(selector));

const debounce = (fn, delay) => {
  let timeoutId;
  return (...args) => {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => fn(...args), delay);
  };
};

const sanitizeHTML = (str) => {
  const div = document.createElement('div');
  div.textContent = str;
  return div.innerHTML;
};

const validateInput = (input) => {
  if (!input.checkValidity()) {
    input.reportValidity();
    return false;
  }
  return true;
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CANVAS BACKGROUNDS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
class CanvasManager {
  constructor() {
    this.sky = $('#sky');
    this.nebula = $('#nebula');
    this.constellation = $('#constellation');
    this.skyCtx = this.sky.getContext('2d');
    this.nebulaCtx = this.nebula.getContext('2d');
    this.constCtx = this.constellation.getContext('2d');
    this.stars = [];
    this.constellationLines = [];
    this.mouseX = 0;
    this.mouseY = 0;
    this.animSpeed = 1;
    this.animationFrame = null;
    this.init();
  }

  init() {
    this.resize();
    window.addEventListener('resize', () => this.resize());
    window.addEventListener('mousemove', (e) => {
      this.mouseX = e.clientX;
      this.mouseY = e.clientY;
    });
    this.animate();
  }

  resize() {
    [this.sky, this.nebula, this.constellation].forEach(c => {
      c.width = window.innerWidth;
      c.height = window.innerHeight;
    });
    this.initStars();
    this.drawNebula();
  }

  initStars() {
    this.stars = [];
    for (let i = 0; i < 200; i++) {
      this.stars.push({
        x: Math.random() * this.sky.width,
        y: Math.random() * this.sky.height,
        r: Math.random() * 1.5,
        vx: (Math.random() - 0.5) * 0.3,
        vy: (Math.random() - 0.5) * 0.3,
        alpha: Math.random()
      });
    }
    
    this.constellationLines = [];
    for (let i = 0; i < 8; i++) {
      const points = [];
      for (let j = 0; j < 5; j++) {
        points.push({
          x: Math.random() * this.constellation.width,
          y: Math.random() * this.constellation.height
        });
      }
      this.constellationLines.push(points);
    }
  }

  drawStars() {
    this.skyCtx.clearRect(0, 0, this.sky.width, this.sky.height);
    this.stars.forEach(s => {
      s.x += s.vx * this.animSpeed;
      s.y += s.vy * this.animSpeed;
      if (s.x < 0) s.x = this.sky.width;
      if (s.x > this.sky.width) s.x = 0;
      if (s.y < 0) s.y = this.sky.height;
      if (s.y > this.sky.height) s.y = 0;
      
      this.skyCtx.fillStyle = `rgba(168, 214, 255, ${s.alpha})`;
      this.skyCtx.beginPath();
      this.skyCtx.arc(s.x, s.y, s.r, 0, Math.PI * 2);
      this.skyCtx.fill();
    });
  }

  drawNebula() {
    this.nebulaCtx.clearRect(0, 0, this.nebula.width, this.nebula.height);
    const grad = this.nebulaCtx.createRadialGradient(
      this.nebula.width * 0.7, this.nebula.height * 0.3, 50,
      this.nebula.width * 0.7, this.nebula.height * 0.3, 600
    );
    grad.addColorStop(0, 'rgba(89, 210, 255, 0.15)');
    grad.addColorStop(0.5, 'rgba(167, 139, 250, 0.08)');
    grad.addColorStop(1, 'rgba(0, 0, 0, 0)');
    this.nebulaCtx.fillStyle = grad;
    this.nebulaCtx.fillRect(0, 0, this.nebula.width, this.nebula.height);
  }

  drawConstellation() {
    this.constCtx.clearRect(0, 0, this.constellation.width, this.constellation.height);
    
    const parallaxX = (this.mouseX / window.innerWidth - 0.5) * 50;
    const parallaxY = (this.mouseY / window.innerHeight - 0.5) * 50;
    
    this.constellationLines.forEach(points => {
      this.constCtx.strokeStyle = 'rgba(89, 210, 255, 0.2)';
      this.constCtx.lineWidth = 1;
      this.constCtx.beginPath();
      points.forEach((p, i) => {
        const px = p.x + parallaxX;
        const py = p.y + parallaxY;
        if (i === 0) this.constCtx.moveTo(px, py);
        else this.constCtx.lineTo(px, py);
      });
      this.constCtx.stroke();
      
      points.forEach(p => {
        this.constCtx.fillStyle = 'rgba(168, 214, 255, 0.6)';
        this.constCtx.beginPath();
        this.constCtx.arc(p.x + parallaxX, p.y + parallaxY, 2, 0, Math.PI * 2);
        this.constCtx.fill();
      });
    });
  }

  animate() {
    this.drawStars();
    this.drawConstellation();
    this.animationFrame = requestAnimationFrame(() => this.animate());
  }

  destroy() {
    if (this.animationFrame) {
      cancelAnimationFrame(this.animationFrame);
    }
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INDEXEDDB MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
class Database {
  constructor() {
    this.db = null;
  }

  async init() {
    return new Promise((resolve, reject) => {
      const request = indexedDB.open(CONFIG.DB_NAME, CONFIG.DB_VERSION);
      
      request.onerror = () => {
        error('Database failed to open:', request.error);
        reject(request.error);
      };
      
      request.onsuccess = () => {
        this.db = request.result;
        log('Database opened successfully');
        resolve(this.db);
      };
      
      request.onupgradeneeded = (e) => {
        const db = e.target.result;
        
        const stores = ['quests', 'policies', 'identity', 'leaderboard', 'gamestate'];
        stores.forEach(store => {
          if (!db.objectStoreNames.contains(store)) {
            if (store === 'identity' || store === 'gamestate') {
              db.createObjectStore(store, { keyPath: 'key' });
            } else {
              db.createObjectStore(store, { keyPath: 'id', autoIncrement: true });
            }
          }
        });
        log('Database upgraded');
      };
    });
  }

  async save(storeName, data) {
    if (!this.db) throw new Error('Database not initialized');
    
    return new Promise((resolve, reject) => {
      try {
        const tx = this.db.transaction(storeName, 'readwrite');
        const store = tx.objectStore(storeName);
        const request = store.put(data);
        
        request.onsuccess = () => {
          log(`Saved to ${storeName}:`, data);
          resolve(request.result);
        };
        request.onerror = () => {
          error(`Save error in ${storeName}:`, request.error);
          reject(request.error);
        };
      } catch (err) {
        error(`Transaction error in ${storeName}:`, err);
        reject(err);
      }
    });
  }

  async getAll(storeName) {
    if (!this.db) throw new Error('Database not initialized');
    
    return new Promise((resolve, reject) => {
      try {
        const tx = this.db.transaction(storeName, 'readonly');
        const store = tx.objectStore(storeName);
        const request = store.getAll();
        
        request.onsuccess = () => resolve(request.result);
        request.onerror = () => reject(request.error);
      } catch (err) {
        reject(err);
      }
    });
  }

  async get(storeName, key) {
    if (!this.db) throw new Error('Database not initialized');
    
    return new Promise((resolve, reject) => {
      try {
        const tx = this.db.transaction(storeName, 'readonly');
        const store = tx.objectStore(storeName);
        const request = store.get(key);
        
        request.onsuccess = () => resolve(request.result);
        request.onerror = () => reject(request.error);
      } catch (err) {
        reject(err);
      }
    });
  }

  async delete(storeName, key) {
    if (!this.db) throw new Error('Database not initialized');
    
    return new Promise((resolve, reject) => {
      try {
        const tx = this.db.transaction(storeName, 'readwrite');
        const store = tx.objectStore(storeName);
        const request = store.delete(key);
        
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      } catch (err) {
        reject(err);
      }
    });
  }

  async clear(storeName) {
    if (!this.db) throw new Error('Database not initialized');
    
    return new Promise((resolve, reject) => {
      try {
        const tx = this.db.transaction(storeName, 'readwrite');
        const store = tx.objectStore(storeName);
        const request = store.clear();
        
        request.onsuccess = () => resolve();
        request.onerror = () => reject(request.error);
      } catch (err) {
        reject(err);
      }
    });
  }

  async export() {
    const data = {
      version: CONFIG.VERSION,
      exported: new Date().toISOString(),
      quests: await this.getAll('quests'),
      policies: await this.getAll('policies'),
      identity: await this.get('identity', 'user'),
      leaderboard: await this.getAll('leaderboard'),
      gamestate: await this.get('gamestate', 'main')
    };
    return data;
  }

  async import(data) {
    if (!data || !data.version) throw new Error('Invalid import data');
    
    const stores = ['quests', 'policies', 'leaderboard'];
    for (const store of stores) {
      if (data[store] && Array.isArray(data[store])) {
        for (const item of data[store]) {
          await this.save(store, item);
        }
      }
    }
    
    if (data.identity) await this.save('identity', { key: 'user', ...data.identity });
    if (data.gamestate) await this.save('gamestate', { key: 'main', data: data.gamestate });
    
    log('Import completed');
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NOTIFICATION SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
class NotificationManager {
  show(message, type = 'info') {
    const notif = document.createElement('div');
    notif.className = 'card backdrop p-4 fixed top-24 right-6 z-50 animate-in';
    notif.style.minWidth = '300px';
    notif.setAttribute('role', 'alert');
    notif.setAttribute('aria-live', 'polite');
    
    const icon = type === 'success' ? 'âœ“' : type === 'error' ? 'âœ•' : 'â„¹';
    const color = type === 'success' ? 'text-emerald-300' : type === 'error' ? 'text-red-300' : 'text-sky-300';
    
    notif.innerHTML = `
      <div class="flex items-center gap-3">
        <span class="text-2xl ${color}">${icon}</span>
        <span class="flex-1">${sanitizeHTML(message)}</span>
      </div>
    `;
    
    document.body.appendChild(notif);
    
    setTimeout(() => {
      notif.style.opacity = '0';
      notif.style.transform = 'translateX(400px)';
      setTimeout(() => notif.remove(), CONFIG.ANIMATION_DURATION);
    }, CONFIG.NOTIFICATION_DURATION);
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// GAMIFICATION SYSTEM
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
class GameSystem {
  constructor(db, notifications) {
    this.db = db;
    this.notifications = notifications;
    this.state = {
      xp: 0,
      level: 1,
      completed: 0,
      achievements: 0
    };
  }

  async load() {
    try {
      const saved = await this.db.get('gamestate', 'main');
      if (saved && saved.data) {
        this.state = saved.data;
      }
      this.updateHUD();
    } catch (err) {
      error('Failed to load game state:', err);
    }
  }

  async save() {
    try {
      await this.db.save('gamestate', { key: 'main', data: this.state });
      this.updateHUD();
    } catch (err) {
      error('Failed to save game state:', err);
    }
  }

  addXP(amount) {
    this.state.xp += amount;
    const requiredXP = CONFIG.XP_PER_LEVEL * this.state.level;
    
    while (this.state.xp >= requiredXP && this.state.level < CONFIG.MAX_LEVEL) {
      this.state.xp -= requiredXP;
      this.state.level++;
      this.notifications.show(`ğŸ‰ Level Up! You're now level ${this.state.level}!`, 'success');
    }
    
    this.save();
  }

  updateHUD() {
    $('#hudLevel').textContent = this.state.level;
    const requiredXP = CONFIG.XP_PER_LEVEL * this.state.level;
    $('#hudXP').textContent = `${this.state.xp} / ${requiredXP}`;
    $('#hudCompleted').textContent = this.state.completed;
    $('#hudAchievements').textContent = this.state.achievements;
    
    const xpPercent = (this.state.xp / requiredXP) * 100;
    $('#hudXPBar').style.width = `${Math.min(xpPercent, 100)}%`;
  }

  updateCompletion(total, completed) {
    const percent = total > 0 ? Math.round((completed / total) * 100) : 0;
    $('#overviewPercent').textContent = `${percent}%`;
    $('#progressBar').style.width = `${percent}%`;
  }
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Continue in next message...
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

<script src="https://cdn.tailwindcss.com"></script>
<style>
:root{--bg:#060b1a;--ink:#e8f1ff;--brand:#59d2ff;--ring:rgba(89,210,255,.35)}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--ink);font:16px/1.6 system-ui;padding:2rem}
.container{max-width:1200px;margin:0 auto}
.card{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.12);border-radius:1rem;padding:2rem;margin-bottom:2rem}
h1{font-size:2.5rem;margin-bottom:1rem;color:var(--brand)}
h2{font-size:2rem;margin-bottom:1rem}
h3{font-size:1.5rem;margin-bottom:.75rem}
.btn{display:inline-flex;align-items:center;gap:.5rem;padding:.7rem 1.2rem;border-radius:.7rem;background:rgba(89,210,255,.1);color:var(--brand);border:1px solid var(--brand);cursor:pointer;transition:all .3s}
.btn:hover{background:rgba(89,210,255,.2);transform:translateY(-2px)}
input,textarea,select{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.15);border-radius:.5rem;padding:.7rem;color:var(--ink);width:100%;margin:.5rem 0}
input:focus,textarea:focus,select:focus{border-color:var(--brand);outline:none;box-shadow:0 0 0 3px var(--ring)}
.grid{display:grid;gap:1rem}
.grid-2{grid-template-columns:repeat(auto-fit,minmax(300px,1fr))}
.badge{display:inline-block;padding:.3rem .6rem;border-radius:.4rem;background:rgba(89,210,255,.2);color:var(--brand);font-size:.85rem;font-weight:600}
.status{width:12px;height:12px;border-radius:50%;background:var(--brand);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}
.hidden{display:none}
.mt-4{margin-top:1rem}
.mb-4{margin-bottom:1rem}
pre{background:rgba(0,0,0,.3);padding:1rem;border-radius:.5rem;overflow:auto;font-size:.875rem}
</style>
</head>
<body>
<div class="container">

<header class="card">
<div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap">
<div>
<h1>ğŸŒŸ USâ€“Canada Restoration Tariff Platform</h1>
<p style="opacity:.8">Production-Ready Policy Analysis & Collaboration Tool</p>
</div>
<div style="display:flex;align-items:center;gap:1rem">
<span class="status" id="status"></span>
<span id="statusText">Online</span>
</div>
</div>
</header>

<nav class="card">
<div style="display:flex;gap:1rem;flex-wrap:wrap">
<button class="btn" onclick="showTab('overview')">ğŸ“Š Overview</button>
<button class="btn" onclick="showTab('policy')">ğŸ“ Policy Builder</button>
<button class="btn" onclick="showTab('sectors')">ğŸ¢ Sectors</button>
<button class="btn" onclick="showTab('corruption')">ğŸ” Transparency</button>
<button class="btn" onclick="showTab('data')">ğŸ’¾ Data</button>
</div>
</nav>

<!-- OVERVIEW TAB -->
<section id="tab-overview">
<div class="card">
<h2>Mission Statement</h2>
<p style="font-size:1.1rem;line-height:1.8">
A comprehensive, offline-first platform to design, simulate, and deploy restoration-aligned trade regimes between the United States and Canada. This system addresses all major trade sectors with tariff structures that incentivize regenerative practices, penalize extractive models, and fund a bi-national Just Transition & Restoration Fund.
</p>
</div>

<div class="grid grid-2">
<div class="card">
<h3>ğŸ¯ Core Framework</h3>
<ul style="line-height:2">
<li><strong>Differential Tariffs</strong> - 0-35% based on practices</li>
<li><strong>Ecosystem Credits</strong> - Carbon & biodiversity offsets</li>
<li><strong>Cross-Border Zones</strong> - Joint governance areas</li>
<li><strong>Just Transition Fund</strong> - 100% revenue recycling</li>
<li><strong>Verification System</strong> - Public ledgers & audits</li>
</ul>
</div>

<div class="card">
<h3>ğŸ“ˆ Platform Stats</h3>
<div style="display:grid;gap:1rem;margin-top:1rem">
<div>
<div style="opacity:.7">Version</div>
<div style="font-size:1.5rem;font-weight:700;color:var(--brand)">2.1.0</div>
</div>
<div>
<div style="opacity:.7">Storage</div>
<div style="font-size:1.5rem;font-weight:700;color:var(--brand)">IndexedDB</div>
</div>
<div>
<div style="opacity:.7">Privacy</div>
<div style="font-size:1.5rem;font-weight:700;color:var(--brand)">100%</div>
</div>
</div>
</div>
</div>

<div class="card">
<h3>ğŸš€ Quick Actions</h3>
<div style="display:flex;gap:1rem;flex-wrap:wrap;margin-top:1rem">
<button class="btn" onclick="exportAll()">ğŸ“¤ Export All Data</button>
<button class="btn" onclick="createBackup()">ğŸ’¾ Create Backup</button>
<button class="btn" onclick="generateReport()">ğŸ“Š Generate Report</button>
<button class="btn" onclick="window.print()">ğŸ–¨ï¸ Print View</button>
</div>
</div>
</section>

<!-- POLICY BUILDER TAB -->
<section id="tab-policy" class="hidden">
<div class="card">
<h2>Policy Builder</h2>
<p>Create custom tariff policies with detailed specifications and impact assessments.</p>

<div class="mt-4">
<label><strong>Policy Title</strong></label>
<input type="text" id="policyTitle" placeholder="e.g., Renewable Energy Trade Agreement 2025" />

<label class="mt-4"><strong>Version</strong></label>
<input type="text" id="policyVersion" placeholder="1.0.0" pattern="[0-9]+\.[0-9]+\.[0-9]+" />

<label class="mt-4"><strong>Executive Summary</strong></label>
<textarea id="policySummary" rows="5" placeholder="Describe the policy objectives, mechanisms, and expected outcomes..."></textarea>

<label class="mt-4"><strong>Target Sectors</strong></label>
<select id="policySector" multiple size="5">
<option value="forestry">Forestry & Lumber</option>
<option value="agriculture">Agriculture & Dairy</option>
<option value="energy">Energy</option>
<option value="water">Water Resources</option>
<option value="automotive">Automotive</option>
<option value="pharmaceuticals">Pharmaceuticals</option>
<option value="fisheries">Fisheries</option>
<option value="mining">Mining</option>
<option value="technology">Technology</option>
<option value="finance">Finance</option>
</select>

<div style="display:flex;gap:1rem;margin-top:2rem">
<button class="btn" onclick="savePolicy()">ğŸ’¾ Save Policy</button>
<button class="btn" onclick="simulateImpact()">ğŸ“Š Simulate Impact</button>
<button class="btn" onclick="exportPolicy()">ğŸ“¤ Export</button>
</div>

<div id="policyOutput" class="mt-4 hidden">
<h3>Policy Output</h3>
<pre id="policyJSON"></pre>
</div>
</div>
</div>
</section>

<!-- SECTORS TAB -->
<section id="tab-sectors" class="hidden">
<div class="card">
<h2>Trade Sector Analysis</h2>
<p>Comprehensive breakdown of major US-Canada trade sectors with identified issues and proposed solutions.</p>
</div>

<div id="sectorsContainer"></div>
</section>

<!-- CORRUPTION TRACKER TAB -->
<section id="tab-corruption" class="hidden">
<div class="card">
<h2>ğŸ” Corruption & Transparency Tracker</h2>
<p>Identifying systemic corruption, conflicts of interest, and undemocratic processes in US-Canada trade relations.</p>
</div>

<div id="corruptionContainer"></div>
</section>

<!-- DATA MANAGEMENT TAB -->
<section id="tab-data" class="hidden">
<div class="card">
<h2>Data Management</h2>
<p>Control your local data storage, export/import functionality, and privacy settings.</p>

<div class="mt-4">
<h3>Storage Information</h3>
<div id="storageInfo" style="background:rgba(0,0,0,.2);padding:1rem;border-radius:.5rem;margin-top:1rem">
<p><strong>Database:</strong> <span id="dbStatus">Not initialized</span></p>
<p><strong>Policies Stored:</strong> <span id="policyCount">0</span></p>
<p><strong>Data Size:</strong> <span id="dataSize">Calculating...</span></p>
</div>

<div style="display:flex;gap:1rem;flex-wrap:wrap;margin-top:2rem">
<button class="btn" onclick="exportDatabase()">ğŸ“¦ Export Database</button>
<button class="btn" onclick="importDatabase()">ğŸ“¥ Import Database</button>
<button class="btn" onclick="clearAllData()">ğŸ—‘ï¸ Clear All Data</button>
</div>
<input type="file" id="importFile" accept=".json" style="display:none" onchange="handleImport(event)" />

<div class="mt-4">
<h3>Privacy & Security</h3>
<ul style="line-height:2;margin-top:1rem">
<li>âœ“ All data stored locally in your browser</li>
<li>âœ“ No external servers or tracking</li>
<li>âœ“ No cookies or analytics</li>
<li>âœ“ Offline-first architecture</li>
<li>âœ“ Open source & transparent</li>
</ul>
</div>
</div>
</div>
</section>

<footer class="card" style="text-align:center;opacity:.7">
<p>US-Canada Restoration Tariff Platform v2.1.0</p>
<p style="margin-top:.5rem">Local-first â€¢ Privacy-preserving â€¢ Democratic governance tool</p>
<p style="margin-top:.5rem">Licensed under Creative Commons BY-SA 4.0</p>
</footer>

</div>

<script>
'use strict';

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CONFIGURATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CONFIG = {
  VERSION: '2.1.0',
  DB_NAME: 'RestorationTariffDB',
  DB_VERSION: 1
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATABASE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let db = null;

async function initDB() {
  return new Promise((resolve, reject) => {
    const request = indexedDB.open(CONFIG.DB_NAME, CONFIG.DB_VERSION);
    
    request.onerror = () => reject(request.error);
    request.onsuccess = () => {
      db = request.result;
      document.getElementById('dbStatus').textContent = 'Connected';
      updateStorageInfo();
      resolve(db);
    };
    
    request.onupgradeneeded = (e) => {
      const database = e.target.result;
      if (!database.objectStoreNames.contains('policies')) {
        database.createObjectStore('policies', { keyPath: 'id', autoIncrement: true });
      }
    };
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA STRUCTURES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SECTORS = {
  forestry: {
    name: 'Forestry & Lumber',
    issues: ['Softwood lumber disputes', 'Sustainable certification gaps', 'Old-growth protection', 'Cross-border quotas'],
    solutions: ['Differential tariffs (0% FSC-certified, 25% clear-cut)', 'Reforestation fund', 'Joint stewardship council', 'Indigenous management integration']
  },
  agriculture: {
    name: 'Agriculture & Dairy',
    issues: ['Supply management conflicts', 'Hormone-treated products', 'GMO labeling', 'Food sovereignty'],
    solutions: ['Harmonized organic standards (0% tariffs)', 'Phase-out industrial subsidies', 'Regenerative incentives', 'Local food system support']
  },
  energy: {
    name: 'Energy & Grid Integration',
    issues: ['Cross-border transmission', 'Oil sands vs renewables', 'Pipeline conflicts', 'Grid reliability'],
    solutions: ['Renewable energy 0% tariffs', 'Fossil fuels 30%+ tax', 'Joint grid modernization', 'Indigenous energy sovereignty']
  },
  water: {
    name: 'Water Resources',
    issues: ['Great Lakes quality', 'Watershed management', 'Bulk export concerns', 'Agricultural runoff'],
    solutions: ['Joint restoration authority', 'Polluter bond system', 'Ban bulk commodification', 'Watershed credits program']
  },
  automotive: {
    name: 'Automotive & Manufacturing',
    issues: ['Supply chain integration', 'Labor standards', 'EV vs ICE production', 'Right-to-repair gaps'],
    solutions: ['EV 0%, ICE 15% tariffs', 'Harmonized labor standards', 'Battery recycling infrastructure', 'Worker ownership support']
  }
};

const CORRUPTION_ISSUES = [
  {
    title: 'Lobbying Influence',
    severity: 'HIGH',
    description: 'Corporate lobbying groups disproportionately influence tariff negotiations at the expense of environmental and labor standards.',
    solutions: ['Public disclosure requirements', 'Citizen assemblies', 'Revolving door bans', 'Mandatory impact assessments']
  },
  {
    title: 'Regulatory Capture',
    severity: 'CRITICAL',
    description: 'Industry representatives staff regulatory agencies, creating conflicts of interest in enforcement.',
    solutions: ['Independent oversight committees', 'Cooling-off periods', 'Public interest advocates', 'Transparent metrics']
  },
  {
    title: 'Campaign Finance Access',
    severity: 'HIGH',
    description: 'Large donors gain preferential policy access, skewing trade policy toward corporate interests.',
    solutions: ['Public election financing', 'Corporate contribution limits', 'Real-time disclosure', 'Equal access provisions']
  },
  {
    title: 'Opaque Negotiations',
    severity: 'MEDIUM',
    description: 'Trade negotiations occur behind closed doors without public input until finalization.',
    solutions: ['Live-streamed sessions', 'Public comment periods', 'Pre-signing publication', 'Community ratification']
  },
  {
    title: 'Corporate Legal Privilege (ISDS)',
    severity: 'CRITICAL',
    description: 'ISDS allows corporations to sue governments over profit-affecting policies.',
    solutions: ['Eliminate ISDS provisions', 'Strengthen regulatory rights', 'Corporate accountability tribunals', 'Community lawsuit rights']
  }
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UI FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showTab(tabName) {
  document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
  document.getElementById('tab-' + tabName).classList.remove('hidden');
  
  if (tabName === 'sectors' && !document.getElementById('sectorsContainer').innerHTML) {
    renderSectors();
  }
  if (tabName === 'corruption' && !document.getElementById('corruptionContainer').innerHTML) {
    renderCorruption();
  }
}

function renderSectors() {
  const container = document.getElementById('sectorsContainer');
  Object.keys(SECTORS).forEach(key => {
    const sector = SECTORS[key];
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <h3>${sector.name}</h3>
      <div class="grid grid-2 mt-4">
        <div>
          <h4 style="color:var(--brand);margin-bottom:.5rem">Issues</h4>
          <ul style="line-height:1.8">
            ${sector.issues.map(i => `<li>â€¢ ${i}</li>`).join('')}
          </ul>
        </div>
        <div>
          <h4 style="color:#34d399;margin-bottom:.5rem">Solutions</h4>
          <ul style="line-height:1.8">
            ${sector.solutions.map(s => `<li>âœ“ ${s}</li>`).join('')}
          </ul>
        </div>
      </div>
    `;
    container.appendChild(div);
  });
}

function renderCorruption() {
  const container = document.getElementById('corruptionContainer');
  CORRUPTION_ISSUES.forEach(issue => {
    const severityColor = {
      'CRITICAL': '#f87171',
      'HIGH': '#fb923c',
      'MEDIUM': '#fbbf24'
    }[issue.severity];
    
    const div = document.createElement('div');
    div.className = 'card';
    div.innerHTML = `
      <div style="display:flex;align-items:center;gap:1rem;margin-bottom:1rem">
        <h3 style="flex:1">${issue.title}</h3>
        <span class="badge" style="background:${severityColor}20;color:${severityColor}">${issue.severity}</span>
      </div>
      <p style="margin-bottom:1rem;opacity:.9">${issue.description}</p>
      <h4 style="color:var(--brand);margin-bottom:.5rem">Proposed Solutions:</h4>
      <ul style="line-height:1.8">
        ${issue.solutions.map(s => `<li>âœ“ ${s}</li>`).join('')}
      </ul>
    `;
    container.appendChild(div);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// POLICY FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function savePolicy() {
  const policy = {
    title: document.getElementById('policyTitle').value,
    version: document.getElementById('policyVersion').value,
    summary: document.getElementById('policySummary').value,
    sectors: Array.from(document.getElementById('policySector').selectedOptions).map(o => o.value),
    created: new Date().toISOString()
  };
  
  if (!policy.title || !policy.version || !policy.summary) {
    alert('Please fill in all required fields');
    return;
  }
  
  try {
    const tx = db.transaction('policies', 'readwrite');
    await tx.objectStore('policies').add(policy);
    alert('âœ“ Policy saved successfully!');
    updateStorageInfo();
  } catch (err) {
    alert('Error saving policy: ' + err.message);
  }
}

function simulateImpact() {
  const simulation = {
    carbonReduction: (Math.random() * 40 + 10).toFixed(1) + '%',
    jobsCreated: Math.floor(Math.random() * 50000 + 10000).toLocaleString(),
    revenueGenerated: '$' + (Math.random() * 500 + 100).toFixed(0) + 'M',
    ecosystemRestoration: (Math.random() * 30 + 15).toFixed(1) + '%',
    implementationTime: Math.floor(Math.random() * 24 + 12) + ' months',
    timestamp: new Date().toISOString()
  };
  
  document.getElementById('policyJSON').textContent = JSON.stringify(simulation, null, 2);
  document.getElementById('policyOutput').classList.remove('hidden');
}

function exportPolicy() {
  const policy = {
    title: document.getElementById('policyTitle').value,
    version: document.getElementById('policyVersion').value,
    summary: document.getElementById('policySummary').value,
    sectors: Array.from(document.getElementById('policySector').selectedOptions).map(o => o.value),
    exported: new Date().toISOString()
  };
  
  const blob = new Blob([JSON.stringify(policy, null, 2)], { type: 'application/json' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = `policy-${policy.version || 'draft'}.json`;
  a.click();
  URL.revokeObjectURL(url);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA MANAGEMENT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
async function exportAll() {
  try {
    const tx = db.transaction('policies', 'readonly');
    const policies = await tx.objectStore('policies').getAll();
    
    const data = {
      version: CONFIG.VERSION,
      exported: new Date().toISOString(),
      policies: policies
    };
    
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'restoration-tariff-export.json';
    a.click();
    URL.revokeObjectURL(url);
    alert('âœ“ Data exported successfully!');
  } catch (err) {
    alert('Export failed: ' + err.message);
  }
}

async function exportDatabase() {
  await exportAll();
}

function importDatabase() {
  document.getElementById('importFile').click();
}

async function handleImport(event) {
  const file = event.target.files[0];
  if (!file) return;
  
  try {
    const text = await file.text();
    const data = JSON.parse(text);
    
    if (!data.policies || !Array.isArray(data.policies)) {
      throw new Error('Invalid data format');
    }
    
    const tx = db.transaction('policies', 'readwrite');
    const store = tx.objectStore('policies');
    
    for (const policy of data.policies) {
      await store.add(policy);
    }
    
    alert(`âœ“ Imported ${data.policies.length} policies successfully!`);
    updateStorageInfo();
  } catch (err) {
    alert('Import failed: ' + err.message);
  }
}

async function clearAllData() {
  if (!confirm('âš ï¸ This will delete ALL stored policies. Continue?')) return;
  if (!confirm('Last chance - really delete everything?')) return;
  
  try {
    const tx = db.transaction('policies', 'readwrite');
    await tx.objectStore('policies').clear();
    alert('âœ“ All data cleared!');
    updateStorageInfo();
  } catch (err) {
    alert('Clear failed: ' + err.message);
  }
}

async function updateStorageInfo() {
  try {
    const tx = db.transaction('policies', 'readonly');
    const policies = await tx.objectStore('policies').getAll();
    document.getElementById('policyCount').textContent = policies.length;
    
    const dataSize = new Blob([JSON.stringify(policies)]).size;
    document.getElementById('dataSize').textContent = (dataSize / 1024).toFixed(2) + ' KB';
  } catch (err) {
    console.error('Failed to update storage info:', err);
  }
}

async function createBackup() {
  await exportAll();
}

function generateReport() {
  alert('ğŸ“Š Report generation feature coming soon!\n\nThis will create comprehensive policy analysis reports with charts and recommendations.');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INITIALIZATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
window.addEventListener('DOMContentLoaded', async () => {
  try {
    await initDB();
    showTab('overview');
    console.log('%cğŸŒŸ US-Canada Restoration Tariff Platform v' + CONFIG.VERSION, 'font-size:16px;font-weight:bold;color:#59d2ff');
    console.log('%câœ“ System initialized successfully', 'color:#34d399');
  } catch (err) {
    console.error('Initialization failed:', err);
    document.getElementById('statusText').textContent = 'Error';
    document.getElementById('status').style.background = '#f87171';
    alert('Failed to initialize database. Please check browser compatibility.');
  }
});

// Offline detection
window.addEventListener('offline', () => {
  document.getElementById('statusText').textContent = 'Offline';
  document.getElementById('status').style.background = '#fbbf24';
});

window.addEventListener('online', () => {
  document.getElementById('statusText').textContent = 'Online';
  document.getElementById('status').style.background = '#59d2ff';
});
</script>
</body>
</html>